$(function(){
  $("form#new_barkback").on("submit", function(e){
    e.preventDefault();

    var $form = $(this);
    var action = $form.attr("action");
    var params = $form.serialize();

    $.ajax({
      url: action,
      data: params,
      dataType: "json",
      method: "POST"
    })
    .success(function(json){
      var barkback = new Barkback(json);

      var barkbackDIV = barkback.renderDIV()

      $("#barkbacks_<%= howl.id %>").append(barkbackDIV)
      $("#barkback_content_<%=@howl.id%>").val('')
    })
    .error(function(response){
      console.log("Something went wrong...", response)
    })
  })
})

function Barkback(attributes){
  this.content = attributes.content;
  this.id = attributes.id;
  this.howl = attributes.howl;
  this.user = attributes.user;
}

$(function(){
  Barkback.templateSource = $('#barkback-template').html()
  Barkback.template = Handlebars.compile(Barkback.templateSource);
})

Barkback.prototype.renderDIV = function(){
  return Barkback.template(this);
}
